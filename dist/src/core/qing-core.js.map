{"version":3,"file":"qing-core.js","sourceRoot":"","sources":["../../../src/core/qing-core.ts"],"names":[],"mappings":"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","sourcesContent":["import { MessageChannel as msgc } from \"electron-re\";\r\nimport { QingWebApiSdk } from \"qing-web-api-sdk\";\r\nimport { Component, Injectable, Type } from \"@angular/core\";\r\nimport {\r\n  IOEvents,\r\n  RendererEvents,\r\n  RendererFunctions,\r\n  UIEvents,\r\n} from \"./events\";\r\nimport { Event, PluginStore } from \"./plugin-store\";\r\nimport { Plugin } from \"./plugin\";\r\n\r\nexport enum Severity {\r\n  SUCCESS = \"success\",\r\n  ERROR = \"error\",\r\n  INFO = \"info\",\r\n}\r\n\r\nexport type MsgcResponse = {\r\n  error: Error | null;\r\n  data: any;\r\n};\r\n\r\nexport declare type Constructable<T> = new (...args: any[]) => T;\r\n\r\nexport type Environment = {\r\n  production: boolean;\r\n  environment: string;\r\n  bucket: string;\r\n  API_URL: string;\r\n  WEB_RESOURCE_URI: string;\r\n  TEST_GAME_CONFIG_IP_MOBILE: string;\r\n  TEST_GAME_CONFIG_PORT_MOBILE: number;\r\n  APP_DATA_PATH: string;\r\n  USER_DATA_PATH: string;\r\n  TEMP_PATH: string;\r\n  APP_PATH: String;\r\n};\r\n\r\nexport interface FileStat {\r\n  type: string;\r\n  path: string;\r\n  file: string;\r\n  files?: FileStat[];\r\n}\r\n\r\n@Injectable({\r\n  providedIn: \"root\",\r\n})\r\nexport class QingCore extends PluginStore {\r\n  static IoServiceName: string = \"io-service\";\r\n  private pluginVariables = new Map<string, string[]>();\r\n  private services = new Map<string, any>();\r\n  private environment: Environment;\r\n\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  /****************************** Environment Variables Api *****************************/\r\n  public set Environment(env: Environment) {\r\n    this.environment = env;\r\n  }\r\n\r\n  public get Environment(): Environment {\r\n    return this.environment;\r\n  }\r\n\r\n  /********************************** I18N *******************************/\r\n  public InstallI18n(translateObjs: { [k: string]: object }) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.INSTALLI18N, { translateObjs })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public SetDefaultLang(lang: string) {\r\n    msgc.invoke(QingCore.IoServiceName, IOEvents.SET_DEFAULT_LANG, {lang})\r\n  }\r\n\r\n  public GetDefaultLang() {\r\n     return new Promise((resolve, reject) => {\r\n       msgc\r\n         .invoke(QingCore.IoServiceName, IOEvents.GET_DEFAULT_LANG, {})\r\n         .then((res: MsgcResponse) => {\r\n           const { error, data } = res;\r\n           if (error) {\r\n             reject(error);\r\n             return;\r\n           }\r\n\r\n           resolve(data);\r\n         });\r\n     });\r\n  }\r\n\r\n  /**\r\n   * 将angular的service实例注入\r\n   * @param service AngularService\r\n   * @param serviceInstance AngularService Instance\r\n   */\r\n  public InjectService<T>(service: Constructable<T>, serviceInstance: T) {\r\n    this.services.set(service.name, serviceInstance);\r\n  }\r\n\r\n  /**\r\n   * 获取某个Service实例\r\n   * @param service\r\n   */\r\n  public GetService<T>(service: Constructable<T>) {\r\n    return this.services.get((service as any).name) as T;\r\n  }\r\n\r\n  /****************************** Plugin Api *****************************/\r\n\r\n  public PreparePlugins(plugins: Plugin[]): Promise<any> {\r\n    let tasks: Promise<any>[] = []\r\n    plugins.forEach(plugin => {\r\n      tasks.push(this.prepare(plugin))\r\n    })\r\n\r\n    return Promise.all(tasks);\r\n  }\r\n  \r\n\r\n  public DeactivatePlugin(pluginNames: string[]) {\r\n    pluginNames.forEach(pluginName => {\r\n      this.deactivate(pluginName);\r\n    })\r\n  }\r\n  \r\n\r\n  public ActivatePlugins(plugins: Plugin[]) {\r\n    plugins.forEach(plugin => {\r\n      this.activate(plugin)\r\n    })\r\n  }\r\n\r\n  // TODO: deactive variables\r\n  public DisablePlugin(pluginName: string) {\r\n    // 将插件注册的变量清空\r\n    this.deactivate(pluginName)\r\n    const variables = this.pluginVariables.get(pluginName);\r\n\r\n    if (variables && variables.length > 0) {\r\n      const observers = variables.map((varName) =>\r\n        this.observerMap.get(varName)\r\n      );\r\n\r\n      observers.forEach((observer) => {\r\n        if (observer) {\r\n          observer.next(null);\r\n          observer.complete();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /*******************************************************************************/\r\n\r\n  /****************************** UI Api *****************************/\r\n  public RegistComponent(componentName: string, component: Type<Component>) {\r\n    this.Invoke(RendererFunctions.REGIST_COMPONENT, componentName, component);\r\n  }\r\n\r\n  public GetComponent(componentName: string) {\r\n    this.Invoke(RendererFunctions.GET_COMPONENT, componentName);\r\n  }\r\n\r\n  public RegistPlacementComponents(\r\n    placement: string,\r\n    component: Type<Component>\r\n  ) {\r\n    this.Invoke(\r\n      RendererFunctions.REGIST_PLACEMENT_COMPONENTS,\r\n      placement,\r\n      component\r\n    );\r\n  }\r\n\r\n  public GetPlacementComponents(placement: string) {\r\n    this.Invoke(RendererFunctions.GET_PLACEMENT_COMPONENTS, placement);\r\n  }\r\n\r\n  public Toast(severity: Severity, message: string) {\r\n    this.Emit(new Event(UIEvents.TOAST, { severity, message }));\r\n  }\r\n\r\n  public Alert(message: string) {\r\n    this.Emit(new Event(UIEvents.ALERT, { message }));\r\n  }\r\n\r\n  public OpenDialog(componentName: string) {\r\n    this.Emit(new Event(UIEvents.OPEN_DIALOG, { componentName }));\r\n  }\r\n\r\n  public CloseDialog() {\r\n    this.Emit(new Event(UIEvents.CLOSE_DIALOG));\r\n  }\r\n\r\n  public ActivateInMenu(\r\n    col: number,\r\n    insertIndex: number,\r\n    label: string,\r\n    cb: Function\r\n  ) {\r\n    this.Emit(\r\n      new Event(UIEvents.ACTIVATE_IN_MENU, { col, insertIndex, label, cb })\r\n    );\r\n  }\r\n\r\n  public DeactivateInMenu(col: number, insertIndex: number) {\r\n    this.Emit(new Event(UIEvents.DEACTIVATE_IN_MENU, { col, insertIndex }));\r\n  }\r\n\r\n  public LoadInSidebar(componentName: string) {\r\n    this.Emit(new Event(UIEvents.LOAD_IN_SIDEBAR, { componentName }));\r\n  }\r\n\r\n  public LoadInEditorArea(componentName: string) {\r\n    this.Emit(new Event(UIEvents.LOAD_IN_EDITORAREA, { componentName }));\r\n  }\r\n\r\n  public LoadInConsolePanel(componentName: string) {\r\n    this.Emit(new Event(UIEvents.LOAD_IN_PANEL, { componentName }));\r\n  }\r\n\r\n  public LoadInWidgetBar(componentName: string) {\r\n    this.Emit(new Event(UIEvents.LOAD_IN_WIDGETBAR, { componentName }));\r\n  }\r\n\r\n  public RegistVariable(pluginName: string, varName: string, data: any) {\r\n    const variables = this.pluginVariables.get(pluginName);\r\n    if (typeof variables === \"object\" && variables.length > 0) {\r\n      if (variables.indexOf(varName) < 0) {\r\n        this.registObserver(varName, data);\r\n      }\r\n    } else {\r\n      this.pluginVariables.set(pluginName, [varName]);\r\n      this.registObserver(varName, data);\r\n    }\r\n  }\r\n\r\n  public GetVariable(varName: string) {\r\n    return this.getObserver(varName) as any;\r\n  }\r\n  /*******************************************************************************/\r\n\r\n  /****************************** Storage Api *****************************/\r\n  public Set(key: string, data: string | object) {\r\n    if (typeof data === \"object\") {\r\n      localStorage.setItem(key, JSON.stringify(data));\r\n    } else {\r\n      localStorage.setItem(key, data);\r\n    }\r\n  }\r\n\r\n  public Get(key: string) {\r\n    const data = localStorage.getItem(key);\r\n\r\n    if (!data) return null;\r\n\r\n    try {\r\n      return JSON.parse(data);\r\n    } catch (error) {\r\n      return data;\r\n    }\r\n  }\r\n\r\n  public Remove(key: string) {\r\n    localStorage.removeItem(key);\r\n  }\r\n  /*******************************************************************************/\r\n\r\n  /****************************** Event Listener Api *****************************/\r\n  public Emit(event: Event) {\r\n    this.dispatchEvent(event);\r\n  }\r\n\r\n  public On(eventName: string, listener: (event: Event) => void) {\r\n    this.addEventListener(eventName, listener);\r\n  }\r\n\r\n  public Once(eventName: string, listener: (event: Event) => void) {\r\n    this.addOnceEventListener(eventName, listener);\r\n  }\r\n\r\n  public Off(eventName: string, listener: (event: Event) => void) {\r\n    this.removeListener(eventName, listener);\r\n  }\r\n\r\n  public OffAll() {\r\n    this.removeAllEvents();\r\n  }\r\n  /*******************************************************************************/\r\n\r\n  public Invoke(funcName: string, ...args: any) {\r\n    return this.execFunction(funcName, ...args);\r\n  }\r\n\r\n  public Bind(funcName: string, fn: (...args: any) => void) {\r\n    this.addFunction(funcName, fn);\r\n  }\r\n\r\n  public UnBind(funcName: string) {\r\n    this.removeFunction(funcName);\r\n  }\r\n\r\n  /****************************** IO Api *****************************************/\r\n  public ListDir(dir: string): Promise<FileStat[]> {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.LISTDIR, {\r\n          dir,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public RemoveDir(dir: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.REMOVEDIR, { dir })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public ReadFile(file: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.READFILE, {\r\n          file,\r\n          options: { encoding: \"utf8\" },\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public WriteFile(file: string, data: any) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.WRITEFILE, {\r\n          file,\r\n          data,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public RemoveFile(file: string, data: any) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.REMOVEFILE, {\r\n          file,\r\n          data,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public ReadJson(path: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.READJSON, {\r\n          path,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public WriteJson(path: string, data: any) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.WRITEJSON, {\r\n          path,\r\n          data,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public DownloadFile(url: string, output: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.DOWNLOADFILE, {\r\n          url,\r\n          output,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public UploadFile(filePath: string, fileName: string) {\r\n    return new Promise(async (resolve, reject) => {\r\n      const qiniuTokenRes = await this.WebServiceSdk.util.getQiniuToken({\r\n        name: fileName,\r\n      });\r\n\r\n      const { token } = qiniuTokenRes.data;\r\n\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.UPLOADFILE, {\r\n          filePath,\r\n          fileName,\r\n          token,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public UploadFiles(files: string[]) {\r\n    return new Promise((resolve, reject) => {});\r\n  }\r\n\r\n  public CopyFiles(source: string, dest: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.COPYFILES, {\r\n          source,\r\n          dest,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public ZipFiles(files: FileStat[], folderName: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.ZIPFILES, {\r\n          files,\r\n          folderName,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  public Unzip(file: string) {\r\n    return new Promise((resolve, reject) => {\r\n      msgc\r\n        .invoke(QingCore.IoServiceName, IOEvents.UNZIP, {\r\n          file,\r\n        })\r\n        .then((res: MsgcResponse) => {\r\n          const { error, data } = res;\r\n          if (error) {\r\n            reject(error);\r\n            return;\r\n          }\r\n\r\n          resolve(data);\r\n        });\r\n    });\r\n  }\r\n\r\n  /*******************************************************************************/\r\n\r\n  /****************************** Web Service Api *****************************************/\r\n\r\n  public get WebServiceSdk() {\r\n    return QingWebApiSdk.getInstance();\r\n  }\r\n\r\n  public InitToken(token: string) {\r\n    this.WebServiceSdk.setToken(token);\r\n  }\r\n  /*******************************************************************************/\r\n\r\n  public Destroy() {\r\n    const observers = Array.from(this.observerMap.values());\r\n    observers.forEach((observer) => {\r\n      observer.next(null);\r\n      observer.complete();\r\n    });\r\n\r\n    super.removeAllListeners();\r\n\r\n    this.OffAll();\r\n  }\r\n}\r\n"]}